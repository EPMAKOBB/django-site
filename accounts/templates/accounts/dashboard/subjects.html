{% extends 'accounts/dashboard/base.html' %}
{% load i18n %}

{% block dashboard_title %}{% trans "Предметы" %}{% endblock %}

{% block dashboard_content %}
  <div class="exam-section">
    {% if exams %}
      {% for exam in exams %}
        <article class="block block--futuristic exam-card">
          <header class="exam-card__header">
            <div>
              <h2 class="exam-card__title">{{ exam.name }}</h2>
              <p class="exam-card__subtitle">{% blocktrans with subject=exam.subject %}Подготовка по предмету «{{ subject }}»{% endblocktrans %}</p>
            </div>
            <div class="exam-card__stats-preview">
              <span class="exam-card__stat">
                <span class="exam-card__stat-value">{{ exam.stats.skill_count }}</span>
                <span class="exam-card__stat-label">{% trans "навыков" %}</span>
              </span>
              <span class="exam-card__stat">
                <span class="exam-card__stat-value">{{ exam.stats.task_type_count }}</span>
                <span class="exam-card__stat-label">{% trans "типов" %}</span>
              </span>
              <span class="exam-card__stat">
                <span class="exam-card__stat-value">{{ exam.stats.task_count }}</span>
                <span class="exam-card__stat-label">{% trans "заданий" %}</span>
              </span>
            </div>
          </header>

          <nav class="exam-tabs" role="tablist" aria-label="{% blocktrans %}Навигация по экзамену {{ exam.name }}{% endblocktrans %}">
            <button
              type="button"
              class="exam-tab is-active"
              data-target="skills-{{ exam.id }}"
              aria-controls="skills-{{ exam.id }}"
              aria-selected="true"
            >{% trans "Навыки" %}</button>
            <button
              type="button"
              class="exam-tab"
              data-target="types-{{ exam.id }}"
              aria-controls="types-{{ exam.id }}"
              aria-selected="false"
            >{% trans "Типы заданий" %}</button>
            <button
              type="button"
              class="exam-tab"
              data-target="stats-{{ exam.id }}"
              aria-controls="stats-{{ exam.id }}"
              aria-selected="false"
            >{% trans "Статистика" %}</button>
          </nav>

          <div class="exam-panels">
            <section id="skills-{{ exam.id }}" class="exam-panel is-active" role="tabpanel">
              {% if exam.skill_groups %}
                <div class="exam-groups">
                  {% for group in exam.skill_groups %}
                    <article class="exam-group">
                      <h3 class="exam-group__title">{{ group.title }}</h3>
                      {% if group.items %}
                        <ul class="exam-skill-list">
                          {% for item in group.items %}
                            <li class="exam-skill">
                              <span class="exam-skill__label">{{ item.label }}</span>
                              <span class="exam-skill__hint">{{ item.skill_name }}</span>
                            </li>
                          {% endfor %}
                        </ul>
                      {% else %}
                        <p class="muted">{% trans "Навыки пока не добавлены." %}</p>
                      {% endif %}
                    </article>
                  {% endfor %}
                </div>
              {% else %}
                <p class="muted">{% trans "Группы навыков пока не добавлены." %}</p>
              {% endif %}
            </section>

            <section id="types-{{ exam.id }}" class="exam-panel" role="tabpanel" hidden>
              {% if exam.task_types %}
                <ul class="exam-types">
                  {% for task_type in exam.task_types %}
                    <li class="exam-type">
                      <div>
                        <h3 class="exam-type__title">{% blocktrans with name=task_type.name %}Тип {{ name }}{% endblocktrans %}</h3>
                        {% if task_type.description %}
                          <p class="exam-type__description">{{ task_type.description }}</p>
                        {% endif %}
                      </div>
                      <span class="exam-type__count">{{ task_type.task_count }}</span>
                    </li>
                  {% endfor %}
                </ul>
              {% else %}
                <p class="muted">{% trans "Типы заданий пока не добавлены." %}</p>
              {% endif %}
            </section>

            <section id="stats-{{ exam.id }}" class="exam-panel" role="tabpanel" hidden>
              <ul class="exam-stats">
                <li>
                  <span class="exam-stats__value">{{ exam.stats.group_count }}</span>
                  <span class="exam-stats__label">{% trans "групп навыков" %}</span>
                </li>
                <li>
                  <span class="exam-stats__value">{{ exam.stats.skill_count }}</span>
                  <span class="exam-stats__label">{% trans "навыков" %}</span>
                </li>
                <li>
                  <span class="exam-stats__value">{{ exam.stats.task_type_count }}</span>
                  <span class="exam-stats__label">{% trans "типов заданий" %}</span>
                </li>
                <li>
                  <span class="exam-stats__value">{{ exam.stats.task_count }}</span>
                  <span class="exam-stats__label">{% trans "заданий" %}</span>
                </li>
              </ul>
            </section>
          </div>
        </article>
      {% endfor %}
    {% else %}
      <p class="muted">{% trans "Экзамены ещё не добавлены." %}</p>
    {% endif %}
  </div>
{% endblock %}
